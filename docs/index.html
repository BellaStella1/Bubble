<script>
        // Get initial count from localStorage or default to 0
        let clickCount = parseInt(localStorage.getItem('bubbleClicks')) || 0; 
        
        // Get the HTML elements by ID
        const bubbleButton = document.getElementById('bubble-button'); 
        const countDisplay = document.getElementById('click-count');
        const wrapElement = document.querySelector('.wrap'); 
        const clickSound = document.getElementById('click-sound-fx'); 
        
        // ðŸ’¡ NEW: Try loading the sound immediately to bypass some restrictions
        clickSound.load(); 

        // Function to update the display text
        function updateTextDisplay() {
            countDisplay.textContent = 'Total Clicks: ' + clickCount;
        }

        // Function to create a floating bubble at a random horizontal position
        function createFloatingBubble(x, y) {
            const newBubble = document.createElement('span');
            newBubble.textContent = 'ðŸ«§';
            newBubble.className = 'floating-bubble';
            
            // Random horizontal positioning near the click
            const randomOffsetX = Math.random() * 50 - 25; 
            
            // Set initial position (using event coordinates for the center)
            newBubble.style.left = `calc(${x}px + ${randomOffsetX}px - 15px)`; 
            newBubble.style.top = `${y}px`; 
            
            wrapElement.appendChild(newBubble);
            
            // Automatically remove the element after the animation is done (2000ms = 2s)
            setTimeout(() => {
                newBubble.remove();
            }, 2000); 
        }

        // Initialize display on page load
        updateTextDisplay(); 
        
        // Define the function that runs on click
        function handleBubbleClick(event) {
            // 1. Play the sound effect
            clickSound.currentTime = 0; 
            // ðŸ’¡ FIX: Use the 'finally' block to attempt to play without waiting
            clickSound.play().catch(e => {
                // If it fails (due to Autoplay Policy), we log the error and continue
                console.error("Sound play blocked:", e);
            }); 

            clickCount += 1; // Increment the counter
            
            // 2. Create the floating bubble at the click position
            createFloatingBubble(event.clientX, event.clientY);
            
            // 3. Update the text display
            updateTextDisplay(); 
            
            // 4. Save the new count to localStorage
            localStorage.setItem('bubbleClicks', clickCount); 
        }

        // 5. Attach the function to the click event
        bubbleButton.addEventListener('click', handleBubbleClick);
        
        // Bonus: Attach event to the whole wrap to allow clicking anywhere to make bubbles
        wrapElement.addEventListener('click', (event) => {
             if (event.target !== bubbleButton) { 
                handleBubbleClick(event);
            }
        });
    </script>
