<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Interactive Bubble Popper</title>
    
    <style>
        html, body {
            height: 100%;
            margin: 0;
            font-family: Arial, sans-serif;
            overflow: hidden; /* Prevent scrollbars when bubbles fly out */
        }
        
        /* Main container layout using Flexbox */
        .wrap {
            height: 100%;
            display: flex;
            flex-direction: column; 
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, #e0f7fa, #b2ebf2);
            text-align: center;
            padding: 20px;
            position: relative; /* Essential for positioning floating bubbles */
        }
        
        /* The clickable button styling */
        #bubble-button { 
            font-size: clamp(48px, 10vw, 128px);
            transition: transform 0.1s; 
            cursor: pointer; 
            z-index: 10; 
            outline: none; /* FIX: Removes the blue focus outline */
            user-select: none; /* NEW: Prevents text/emoji selection which sometimes causes artifacts */
        }
        
        /* Click feedback effect */
        #bubble-button:active {
             transform: scale(0.95); /* Shrink slightly on click for feedback */
        }

        /* Counter display styling */
        #click-count {
            font-size: clamp(16px, 4vw, 24px); 
            margin-top: 20px;
            color: #00838f; 
            font-weight: bold;
            z-index: 10;
        }

        /* CSS Animation for the Floating Bubble */
        @keyframes float-up {
            0% {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
            100% {
                opacity: 0;
                transform: translateY(-50vh) scale(0.5); /* Fly up and shrink */
            }
        }

        /* Styling for the dynamically created floating bubbles */
        .floating-bubble {
            position: absolute;
            font-size: 30px; 
            pointer-events: none; /* Allows clicks to pass through to the button */
            animation: float-up 2s ease-out forwards; /* Run the animation for 2 seconds */
            z-index: 5;
        }
    </style>
</head>
<body>
    
    <div class="wrap">
        <audio id="click-sound-fx" preload="auto">
            <source src="data:audio/mpeg;base64,SUQzBAAAAAAAI1RTU0UAAAAPAAADTGF2ZjU4LjM1LjEwMAAAAAAAAAAAAAAA//tEAAIAoAAAJgAAAAAAAAAAAAAAARIAAAAASAAGACAAgAEAAJAAAAAAAAAAAASGJyZAAAAAAAAEAAAAAAAAAAGQQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/2wBIEAAAAQAAAKC4+gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADQWxhdmY1OC4zNS4xMDAAAAAAAAAAAAAAAP/bMEVwAAAD8AAAAAAAAAAAAGQAAAQBAAAEAcAAAMBwAAAYCAAAABAAABAAABAAABAAMBBAMBBAcBBAYBAAECggIHBgYDAAYGBAQCBAcBAAEHBgYEAAgEBQQCAQYGBQQAAAECAAQDAwQCAgYDBgICAgYDBgICAgYDCwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/4WxEAAQAAAAsQAAAABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEtAVGRhdGECAgMCBAUGChcYGSEiJCUmLTgxPD1BSEpOUVJWW1tqbnB6gYeKjI2PkJGSlJWXmJmaoqOkpqmpqa2xtLe4ur7ExsfIycnLzM/Q0dLT1NXW2Nnc3d7i4uPk5ebm5+jp6uvs7O3u7/Dx8vP09fX29vf4+fr7/P39/f4A" type="audio/mpeg">
            Your browser does not support the audio element.
        </audio>
        
        <span id="bubble-button">ðŸ«§</span> 
        
        <p id="click-count">Total Clicks: 0</p> 
        
    </div>
    
    <script>
        // Get initial count from localStorage or default to 0
        let clickCount = parseInt(localStorage.getItem('bubbleClicks')) || 0; 
        
        // Get the HTML elements by ID
        const bubbleButton = document.getElementById('bubble-button'); 
        const countDisplay = document.getElementById('click-count');
        const wrapElement = document.querySelector('.wrap'); 
        const clickSound = document.getElementById('click-sound-fx'); 
        
        // Load the sound immediately to help bypass some browser restrictions
        clickSound.load(); 

        // Function to update the display text
        function updateTextDisplay() {
            countDisplay.textContent = 'Total Clicks: ' + clickCount;
        }

        // Function to create a floating bubble at a random horizontal position
        function createFloatingBubble(x, y) {
            const newBubble = document.createElement('span');
            newBubble.textContent = 'ðŸ«§';
            newBubble.className = 'floating-bubble';
            
            // Random horizontal positioning near the click
            const randomOffsetX = Math.random() * 50 - 25; 
            
            // Set initial position (using event coordinates for the center)
            newBubble.style.left = `calc(${x}px + ${randomOffsetX}px - 15px)`; 
            newBubble.style.top = `${y}px`; 
            
            wrapElement.appendChild(newBubble);
            
            // Automatically remove the element after the animation is done (2000ms = 2s)
            setTimeout(() => {
                newBubble.remove();
            }, 2000); 
        }

        // Initialize display on page load
        updateTextDisplay(); 
        
        // Define the function that runs on click
        function handleBubbleClick(event) {
            // 1. Play the sound effect
            clickSound.currentTime = 0; 
            clickSound.play().catch(e => console.error("Sound play blocked:", e)); 

            clickCount += 1; // Increment the counter
            
            // 2. Create the floating bubble at the click position
            // Use clientX/Y from the event if available, otherwise estimate based on button position
            let clickX = event.clientX;
            let clickY = event.clientY;

            // Fallback for clicks outside the button
            if (event.target === wrapElement) {
                clickX = event.clientX;
                clickY = event.clientY;
            } else if (event.target === bubbleButton) {
                 const rect = bubbleButton.getBoundingClientRect();
                 clickX = rect.left + rect.width / 2;
                 clickY = rect.top + rect.height / 2;
            }


            createFloatingBubble(clickX, clickY);
            
            // 3. Update the text display
            updateTextDisplay(); 
            
            // 4. Save the new count to localStorage
            localStorage.setItem('bubbleClicks', clickCount); 
        }

        // 5. Attach the function to the click event
        bubbleButton.addEventListener('click', handleBubbleClick);
        
        // Bonus: Attach event to the whole wrap to allow clicking anywhere to make bubbles
        wrapElement.addEventListener('click', (event) => {
             // Only run if the click was not directly on the button (to avoid double count)
             if (event.target !== bubbleButton) { 
                handleBubbleClick(event);
            }
        });
    </script>
    
</body>
</html>
